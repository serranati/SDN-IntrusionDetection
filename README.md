# SDN-IntrusionDetection
This project implements a simple Machine Learningâ€“based Intrusion Detection System (IDS) for Software-Defined Networking (SDN).  
The goal is to let an **ONOS controller** extract flow information from the network, send it to an external **REST API**, and receive a classification such as *benign* or *malicious*.  
The REST API will integrate a trained ML model for detecting attacks such as DDoS.

---

## ðŸ“ Repository Structure

```
.
â”œâ”€â”€ ML-training.ipynb       # Jupyter notebook used to train the ML model
â”‚
â”œâ”€â”€ rest_api/
â”‚   â””â”€â”€ server.py           # FastAPI REST server receiving flow data from ONOS
â”‚
â””â”€â”€ onos/                   # ONOS application source code
â”‚   â””â”€â”€ apps/ids            # Java code for the IDS ONOS application
â”‚   â””â”€â”€ ...                 # Other ONOS project files

```

---
## ðŸ“Š InSDN Dataset (2020)

This project uses the **InSDN (Intrusion Detection for Software-Defined Networks) Dataset**, published in *IEEE Access (2020)* as part of the paper:

> **â€œInSDN: Intrusion Detection System Using Deep Learning for Software Defined Networksâ€**
> Muhammad Umar Javaid et al., IEEE Access, 2020.
> [https://ieeexplore.ieee.org/document/9187858](https://ieeexplore.ieee.org/document/9187858)

The dataset is available on Kaggle:
[https://www.kaggle.com/datasets/muhammadumarjavaid/insdn-dataset-2020](https://www.kaggle.com/datasets/muhammadumarjavaid/insdn-dataset-2020)

InSDN is a **flow-based intrusion detection dataset designed specifically for SDN environments**, containing labeled traffic for various attack types (e.g., DoS, DDoS, probing, botnet traffic) as well as benign flows. Each flow record contains a rich set of statistical features (packet counts, byte counts, durations, IP/port information, protocol metadata, and aggregated flow-level metrics).

---

## Running the REST API Server

The IDS REST API is implemented using **FastAPI**.

1. Install dependencies:
   ```bash
   pip install fastapi uvicorn
    ```

2. Start the server:

   ```bash
   uvicorn rest_api.server:app --host 0.0.0.0 --port 5000
   ```

3. The API will be available at:

   ```
   POST http://localhost:5000/predict
   ```

4. Interactive API documentation (auto-generated by FastAPI) is available at:

   ```
   http://localhost:5000/docs
   ```

ONOS will send flow statistics to this endpoint for classification.

---

## ONOS IDS Application

This project includes a custom **ONOS application** that periodically collects flow statistics from all switches in the SDN network and forwards these flow features to the external REST API for classification.

### How It Works

* The app is implemented in Java and packaged as an OAR bundle.
* Every *N* seconds, it:

  1. Retrieves all **FlowEntry** objects from the ONOS `FlowRuleService`.
  2. Extracts relevant flow statistics:
     * Flow id
     * Device id
     * Packet count
     * Byte count
     * Duration
     * Packets per second
     * Bytes per second
     * Last seen
     * IP addresses (source + destination)
     * TCP/UDP ports (source + destination)
     * IP protocol
     * MAC addresses (source + destination)
  3. Converts each flow entry into JSON.
  4. Sends this JSON via HTTP POST to the REST API endpoint:

     ```
     http://localhost:5000/predict
     ```
  5. Receives a classification label (e.g., `"benign"` or `"malicious"`).
  6. Presents the results to the user with ONOS CLI commands, namely `ids-detections` and `ids-attack-info`.

This keeps the ONOS controller lightweight: all ML processing is done externally, and ONOS only performs data extraction and response handling.

---

### Installing the App into ONOS

Build the application as an OAR file and install it into your ONOS Docker container as follows:

1. **Build the application with Bazel:**

   ```bash
   cd onos/
   bazel build //apps/ids:onos-apps-ids-oar --extra_toolchains=@rules_python//python:autodetecting_toolchain_nonstrict
   ```

2. **Copy the OAR file into the ONOS container:**

   ```bash
   docker cp onos/bazel-bin/apps/ids/onos-apps-ids-oar.oar onos:/root/onos/apps
   ```

3. **Enter the container:**

   ```bash
   docker exec -it onos /bin/bash
   ```

4. **Install the application:**

   ```bash
   bin/onos-app localhost install apps/onos-apps-ids-oar.oar
   ```

5. **Open the ONOS CLI:**

   ```bash
   bin/onos -l onos
   ```

6. **Activate the IDS application:**

   ```bash
   app activate ids
   ```

7. (Optional) **View last predictions** using the custom CLI command:

   ```bash
   ids-stats
   ```

Once activated, the ONOS controller will automatically begin sending flow statistics to the REST API for real-time intrusion detection.
